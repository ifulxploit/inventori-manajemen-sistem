IDENTIFICATION DIVISION.
PROGRAM-ID. INVENTORY-MANAGEMENT.

DATA DIVISION.
FILE SECTION.
FD INVENTORY-FILE
    RECORDING MODE IS F
    BLOCK CONTAINS 0 RECORDS
    RECORD CONTAINS 100 CHARACTERS
    LABEL RECORDS ARE STANDARD.
FD INVENTORY-REPORT
   RECORDING MODE IS F
   BLOCK CONTAINS 0 RECORDS
   RECORD CONTAINS 100 CHARACTERS
   LABEL RECORDS ARE STANDARD.
01 INVENTORY-RECORD.
    05 ITEM-CODE      PIC X(10).
    05 ITEM-NAME      PIC X(30).
    05 ITEM-QUANTITY  PIC 9(5).
    05 ITEM-MIN-QTY PIC 9(5).
    05 ITEM-MAX-QTY PIC 9(5).


PROCEDURE DIVISION.
MAIN-PARAGRAPH.
    DISPLAY "Welcome to Inventory Management System".
    DISPLAY "1. Add new inventory".
    DISPLAY "2. Delete inventory".
    DISPLAY "3. Update inventory".
    DISPLAY "4. Riport inventory".
    DISPLAY "5. ".
    DISPLAY "Enter your choice: ".
    ACCEPT CHOICE.
    PERFORM PROCESS-CHOICE UNTIL CHOICE = 5.
    STOP RUN.

PROCESS-CHOICE.
    IF CHOICE = 1 THEN
        PERFORM ADD-INVENTORY
    ELSE IF CHOICE = 2 THEN
        PERFORM DELETE-INVENTORY
    ELSE IF CHOICE = 3 THEN
        PERFORM UPDATE-INVENTORY
    ELSE IF CHOICE = 4 THEN
        PERFORM DISPLAY-INVENTORY-REPORT
    END-IF.


ADD-INVENTORY.
    DISPLAY "Enter item code: ".
    ACCEPT ITEM-CODE.
    DISPLAY "Enter item name: ".
    ACCEPT ITEM-NAME.
    DISPLAY "Enter item quantity: ".
    ACCEPT ITEM-QUANTITY.
    DISPLAY "Enter minimum item quantity: ".
    ACCEPT ITEM-MIN-QTY.
    DISPLAY "Enter maximum item quantity: ".
    ACCEPT ITEM-MAX-QTY.
    WRITE INVENTORY-RECORD.
    DISPLAY "Inventory added successfully".

DELETE-INVENTORY.
    DISPLAY "Enter item code to delete: ".
    ACCEPT ITEM-CODE.
    DELETE INVENTORY-RECORD
        INVALID KEY DISPLAY "Item not found".
    DISPLAY "Inventory deleted successfully".

UPDATE-INVENTORY.
    DISPLAY "Enter item code to update: ".
    ACCEPT ITEM-CODE.
    DISPLAY "Enter new item name: ".
    ACCEPT ITEM-NAME.
    DISPLAY "Enter new item quantity: ".
    ACCEPT ITEM-QUANTITY.
    REWRITE INVENTORY-RECORD
        INVALID KEY DISPLAY "Item not found".
    DISPLAY "Inventory updated successfully".

DISPLAY-INVENTORY-REPORT.
   OPEN OUTPUT INVENTORY-REPORT.
   DISPLAY "Inventory Report".
   MOVE "Item Code" TO INVENTORY-RECORD.
   MOVE "Item Name" TO INVENTORY-RECORD(12:9).
   MOVE "Quantity" TO INVENTORY-RECORD(42:8).
   MOVE "Min Qty" TO INVENTORY-RECORD(50:7).
   MOVE "Max Qty" TO INVENTORY-RECORD(63:7).
   WRITE INVENTORY-RECORD TO INVENTORY-REPORT.
   PERFORM UNTIL EOF-FLAG
       READ INVENTORY-FILE
           AT END
               SET EOF-FLAG TO TRUE
           NOT AT END
             IF ITEM-QUANTITY < ITEM-MIN-QTY OR ITEM-QUANTITY > ITEM-MAX-QTY
                 MOVE ITEM-CODE TO INVENTORY-RECORD.
                 MOVE ITEM-NAME TO INVENTORY-RECORD(12:30).
                 MOVE ITEM-QUANTITY TO INVENTORY-RECORD(42:5).
                 MOVE ITEM-MIN-QTY TO INVENTORY-RECORD(50:7).
                 MOVE ITEM-MAX-QTY TO INVENTORY-RECORD(63:7).
                 WRITE INVENTORY-RECORD TO INVENTORY-REPORT
              END-IF
       END-READ
   END-PERFORM.
   CLOSE INVENTORY-REPORT.
   DISPLAY "Inventory report generated successfully".
